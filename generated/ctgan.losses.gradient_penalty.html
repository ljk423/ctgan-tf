

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ctgan.losses.gradient_penalty &mdash; ctgan-tf 0.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/tf-ctgan-icon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/imbalanced-learn.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ctgan.cli.cli" href="ctgan.cli.cli.html" />
    <link rel="prev" title="ctgan.losses.conditional_loss" href="ctgan.losses.conditional_loss.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ctgan-tf
          

          
            
            <img src="../_static/tf-ctgan-200.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">TensorFlow CTGAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html#getting-started">Getting started</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance_comparison.html">Performance Comparison</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">ctgan-tf API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.synthesizer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.synthesizer</span></code>: CTGAN Synthesizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.data_modules"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.data_modules</span></code>: Data modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.models</span></code>: Neural Network and Transformer Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.layers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.layers</span></code>: Neural Network Layers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-ctgan.losses"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.losses</span></code>: Model losses</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ctgan.losses.conditional_loss.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.losses</span></code>.conditional_loss</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.losses</span></code>.gradient_penalty</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.cli"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.cli</span></code>: Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-ctgan.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.utils</span></code>: Utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ctgan-tf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">ctgan-tf API</a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.losses</span></code>.gradient_penalty</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ctgan-losses-gradient-penalty">
<h1><a class="reference internal" href="../api.html#module-ctgan.losses" title="ctgan.losses"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctgan.losses</span></code></a>.gradient_penalty<a class="headerlink" href="#ctgan-losses-gradient-penalty" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="ctgan.losses.gradient_penalty">
<code class="sig-prename descclassname">ctgan.losses.</code><code class="sig-name descname">gradient_penalty</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">real</em>, <em class="sig-param">fake</em>, <em class="sig-param">pac=10</em>, <em class="sig-param">gp_lambda=10.0</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/pbmartins/ctgan-tf/blob/42a92e5/ctgan/losses/_gradient_penalty.py#L7"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ctgan.losses.gradient_penalty" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the gradient penalty loss for a batch of “averaged” samples.</p>
<p>In Improved WGANs, the 1-Lipschitz constraint is enforced by adding a term
to the loss function that penalizes the network if the gradient norm moves
away from 1. However, it is impossible to evaluate this function at all
points in the input space. The compromise used in the paper is to choose
random points on the lines between real and generated samples, and check
the gradients at these points. Note that it is the gradient w.r.t. the
input averaged samples, not the weights of the discriminator,
that we’re penalizing!</p>
<p>In order to evaluate the gradients, we must first run samples through the
generator and evaluate the loss. Then we get the gradients of the
discriminator w.r.t. the input averaged samples. The L2 norm and penalty
can then be calculated for this gradient.</p>
<p>For more information check the WGAN-GP paper <a class="bibtex reference internal" href="../references.html#gulrajani2017improved" id="id1">[GAA+17]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>func: function</strong></dt><dd><p>The gradient penalty will be computed over the output of this
method.</p>
</dd>
<dt><strong>real: tf.Tensor</strong></dt><dd><p>Real sample batch.</p>
</dd>
<dt><strong>fake: tf.Tensor</strong></dt><dd><p>Fake sample batch.</p>
</dd>
<dt><strong>pac: int, default=10</strong></dt><dd><p>Size of the Pac framework. For more details consult the original
paper and the PacGAN framework paper <a class="bibtex reference internal" href="../references.html#lin2018pacgan" id="id2">[LKFO18]</a>.</p>
</dd>
<dt><strong>gp_lambda: float, default=10.0</strong></dt><dd><p>Gradient Penalty lambda.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>tf.Tensor</dt><dd><p>The gradient penalty of the interpolated sample batch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<div style='clear:both'></div></div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ctgan.cli.cli.html" class="btn btn-neutral float-right" title="ctgan.cli.cli" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ctgan.losses.conditional_loss.html" class="btn btn-neutral float-left" title="ctgan.losses.conditional_loss" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, MIT Data To AI Lab &amp; Pedro Martins

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>